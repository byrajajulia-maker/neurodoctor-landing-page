-- Таблица услуг
CREATE TABLE IF NOT EXISTS services (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    price INTEGER NOT NULL,
    duration VARCHAR(100) NOT NULL,
    description TEXT NOT NULL,
    category VARCHAR(50) NOT NULL,
    icon VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Таблица командировок
CREATE TABLE IF NOT EXISTS business_trips (
    id SERIAL PRIMARY KEY,
    city VARCHAR(255) NOT NULL,
    current_applications INTEGER DEFAULT 0,
    required_for_trip INTEGER DEFAULT 8,
    status VARCHAR(20) DEFAULT 'active' CHECK (status IN ('active', 'planned', 'completed')),
    trip_dates VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Таблица статей и материалов
CREATE TABLE IF NOT EXISTS articles (
    id SERIAL PRIMARY KEY,
    title VARCHAR(500) NOT NULL,
    category VARCHAR(100) NOT NULL,
    excerpt TEXT NOT NULL,
    content TEXT NOT NULL,
    publish_date DATE NOT NULL,
    tags TEXT[],
    views INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Таблица отзывов
CREATE TABLE IF NOT EXISTS testimonials (
    id SERIAL PRIMARY KEY,
    client_name VARCHAR(255) NOT NULL,
    city VARCHAR(255) NOT NULL,
    text TEXT NOT NULL,
    date DATE NOT NULL,
    rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
    photo_url VARCHAR(500),
    is_published BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Индексы для оптимизации
CREATE INDEX IF NOT EXISTS idx_services_category ON services(category);
CREATE INDEX IF NOT EXISTS idx_trips_status ON business_trips(status);
CREATE INDEX IF NOT EXISTS idx_trips_city ON business_trips(city);
CREATE INDEX IF NOT EXISTS idx_articles_category ON articles(category);
CREATE INDEX IF NOT EXISTS idx_articles_publish_date ON articles(publish_date);
CREATE INDEX IF NOT EXISTS idx_testimonials_rating ON testimonials(rating);
CREATE INDEX IF NOT EXISTS idx_testimonials_published ON testimonials(is_published);

-- Вставка данных для услуг
INSERT INTO services (title, price, duration, description, category, icon) VALUES
('Первичная консультация', 2500, '60 минут', 'Знакомство с ребёнком, сбор анамнеза, первичная оценка развития и определение проблемных зон', 'consultation', 'ClipboardList'),
('Комплексная диагностика', 5000, '90-120 минут', 'Полное нейропсихологическое обследование с использованием стандартизированных методик, письменное заключение с рекомендациями', 'diagnostics', 'FileSearch'),
('Коррекционное занятие', 3000, '45-60 минут', 'Индивидуальное развивающее занятие по программе с использованием нейропсихологических методик', 'therapy', 'Users'),
('Консультация для родителей', 2000, '45 минут', 'Обучение родителей методам домашней работы, ответы на вопросы, корректировка стратегии развития', 'consultation', 'MessageSquare'),
('Повторная диагностика', 4000, '60-90 минут', 'Оценка динамики развития, корректировка программы коррекции, новые рекомендации', 'diagnostics', 'RefreshCw'),
('Абонемент 8 занятий', 22000, '1 месяц', 'Месячный абонемент на 8 коррекционных занятий со скидкой 8%', 'package', 'Package'),
('Абонемент 12 занятий', 31500, '1.5 месяца', 'Курс из 12 занятий со скидкой 13% - оптимальный вариант для стабильной динамики', 'package', 'Package');

-- Вставка данных для командировок
INSERT INTO business_trips (city, current_applications, required_for_trip, status, trip_dates) VALUES
('Казань', 6, 8, 'active', NULL),
('Екатеринбург', 4, 8, 'active', NULL),
('Новосибирск', 8, 8, 'planned', 'Июнь 2025'),
('Краснодар', 2, 8, 'active', NULL),
('Владивосток', 10, 8, 'completed', 'Март 2025'),
('Иркутск', 3, 8, 'active', NULL);

-- Вставка данных для статей
INSERT INTO articles (title, category, excerpt, content, publish_date, tags) VALUES
('Что такое нейродефектология и чем она отличается от обычной дефектологии?', 
'Основы', 
'Нейродефектология — это современный подход к коррекции развития, основанный на понимании работы мозга', 
'Нейродефектология объединяет знания нейропсихологии, коррекционной педагогики и дефектологии. Специалист работает не только с симптомами, но и с причинами нарушений развития, воздействуя на механизмы работы мозга. В отличие от классической дефектологии, используются методы, учитывающие особенности формирования нейронных связей у детей с различными диагнозами.', 
'2025-01-15', 
ARRAY['нейродефектология', 'основы', 'методики']),

('5 признаков задержки речевого развития у детей 2-3 лет', 
'Речевое развитие', 
'Как понять, что ребёнку нужна помощь специалиста? Разбираем ключевые маркеры ЗРР', 
'1. Ребёнок в 2 года не говорит простые слова (мама, папа, дай). 2. Отсутствует указательный жест и желание коммуницировать. 3. Не реагирует на своё имя или простые просьбы. 4. К 2.5 годам словарный запас менее 20 слов. 5. К 3 годам не строит простые фразы из 2-3 слов. При наличии 2-3 признаков рекомендуется консультация специалиста.', 
'2025-02-20', 
ARRAY['ЗРР', 'речь', 'диагностика', 'родителям']),

('Нейропсихологические игры для развития внимания дома', 
'Практические советы', 
'Простые упражнения, которые можно делать с ребёнком каждый день для улучшения концентрации', 
'Игра "Найди отличия" развивает зрительное внимание. "Что изменилось?" тренирует память и наблюдательность. "Хлопни, когда услышишь слово" развивает слуховое внимание. "Лабиринты" улучшают произвольность и планирование. Рекомендуется заниматься 10-15 минут ежедневно в игровой форме, постепенно усложняя задания.', 
'2025-03-10', 
ARRAY['внимание', 'игры', 'упражнения', 'дома']),

('РАС у детей: как проходит коррекция с нейродефектологом', 
'Диагнозы', 
'Особенности работы с детьми с расстройством аутистического спектра', 
'Работа с детьми с РАС требует особого подхода: создание предсказуемой структуры занятий, использование визуальных подсказок, метод маленьких шагов, поощрение любых попыток коммуникации. Важно работать над сенсорной интеграцией, развитием социальных навыков и снижением тревожности. Занятия адаптируются под текущее состояние ребёнка, используются его интересы как мотивация.', 
'2025-03-25', 
ARRAY['РАС', 'аутизм', 'коррекция', 'методики']),

('Когда стоит обратиться к нейродефектологу: чек-лист для родителей', 
'Для родителей', 
'Список ситуаций, при которых консультация специалиста необходима', 
'Обращайтесь к специалисту, если: ребёнок отстаёт в речевом развитии от сверстников; есть трудности с концентрацией внимания и усидчивостью; наблюдаются проблемы с координацией и моторикой; ребёнок не может выполнять простые инструкции; есть сложности в общении с другими детьми; поставлен диагноз ЗПР, ЗПРР, РАС, СДВГ; ребёнок переживает стресс или травму. Раннее обращение повышает эффективность коррекции.', 
'2025-04-05', 
ARRAY['родителям', 'диагностика', 'когда обращаться']),

('СДВГ или особенности темперамента: как отличить', 
'Диагнозы', 
'Не каждый активный ребёнок имеет СДВГ. Разбираем признаки настоящего расстройства', 
'СДВГ характеризуется: импульсивностью, мешающей обучению; невозможностью усидеть даже 5 минут; постоянным отвлечением на любые стимулы; сложностями в завершении начатого; проблемами в нескольких сферах (дома, в саду, с друзьями). Активный темперамент: ребёнок может сосредоточиться на интересном; способен успокоиться и слушать; поведение зависит от обстановки. Диагноз ставит врач после наблюдения.', 
'2025-04-18', 
ARRAY['СДВГ', 'гиперактивность', 'диагностика']);

-- Вставка данных для отзывов
INSERT INTO testimonials (client_name, city, text, date, rating, photo_url) VALUES
('Анна М.', 'Москва', 
'Обратились с проблемой задержки речевого развития у сына (3 года). После 4 месяцев занятий результаты превзошли все ожидания! Ребёнок начал говорить фразами, улучшилось внимание. Огромная благодарность за профессионализм и терпение!', 
'2025-03-15', 5, 
'https://cdn.poehali.dev/projects/a166d6d7-2fe8-428d-8ea8-cfa2f49ef647/files/de2690a1-2ffb-410f-ae2b-3a161af64098.jpg'),

('Елена К.', 'Санкт-Петербург', 
'Работаем уже полгода с диагнозом РАС. Дочка стала более контактной, появился зрительный контакт, снизилась тревожность. Специалист находит подход к ребёнку, всегда даёт подробные рекомендации для работы дома.', 
'2025-04-02', 5, 
'https://cdn.poehali.dev/projects/a166d6d7-2fe8-428d-8ea8-cfa2f49ef647/files/de2690a1-2ffb-410f-ae2b-3a161af64098.jpg'),

('Мария С.', 'Казань', 
'Сыну 5 лет, диагноз ЗПРР. Занимаемся 8 месяцев. Динамика потрясающая: улучшилась координация, речь стала более развёрнутой, появился интерес к обучению. Рекомендую всем, кто ищет грамотного специалиста!', 
'2025-04-10', 5, 
'https://cdn.poehali.dev/projects/a166d6d7-2fe8-428d-8ea8-cfa2f49ef647/files/de2690a1-2ffb-410f-ae2b-3a161af64098.jpg'),

('Ольга Д.', 'Екатеринбург', 
'Очень благодарны за помощь! Дочка с синдромом Дауна стала более самостоятельной, улучшилась мелкая моторика и внимание. Занятия проходят в комфортной обстановке, ребёнок всегда идёт с удовольствием.', 
'2025-04-20', 5, 
'https://cdn.poehali.dev/projects/a166d6d7-2fe8-428d-8ea8-cfa2f49ef647/files/de2690a1-2ffb-410f-ae2b-3a161af64098.jpg'),

('Дмитрий П.', 'Новосибирск', 
'После консультации получили чёткий план действий и понимание, как помочь сыну с СДВГ. Занятия дают результат - ребёнок стал спокойнее, может концентрироваться на задачах. Спасибо за профессионализм!', 
'2025-03-28', 5, 
'https://cdn.poehali.dev/projects/a166d6d7-2fe8-428d-8ea8-cfa2f49ef647/files/de2690a1-2ffb-410f-ae2b-3a161af64098.jpg'),

('Наталья В.', 'Краснодар', 
'Работаем уже год. Дочке поставили задержку психического развития в 4 года. Сейчас ей 5, и она догнала сверстников по многим показателям! Невероятно благодарна за индивидуальный подход и веру в моего ребёнка.', 
'2025-04-15', 5, 
'https://cdn.poehali.dev/projects/a166d6d7-2fe8-428d-8ea8-cfa2f49ef647/files/de2690a1-2ffb-410f-ae2b-3a161af64098.jpg'),

('Светлана Л.', 'Владивосток', 
'Приезжала специалист в наш город на 3 недели. За это время провели диагностику и 10 занятий. Получили огромный толчок в развитии! Сын стал более внимательным, речь улучшилась. Ждём следующего приезда!', 
'2025-03-20', 5, 
'https://cdn.poehali.dev/projects/a166d6d7-2fe8-428d-8ea8-cfa2f49ef647/files/de2690a1-2ffb-410f-ae2b-3a161af64098.jpg'),

('Александра Т.', 'Иркутск', 
'После первой консультации сразу стало понятно, в каком направлении двигаться. Специалист объяснила всё доступно, дала конкретные упражнения для дома. Планируем продолжать занятия курсом.', 
'2025-04-08', 5, 
'https://cdn.poehali.dev/projects/a166d6d7-2fe8-428d-8ea8-cfa2f49ef647/files/de2690a1-2ffb-410f-ae2b-3a161af64098.jpg');